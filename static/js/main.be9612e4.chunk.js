(this["webpackJsonpstraight-line-challenge"]=this["webpackJsonpstraight-line-challenge"]||[]).push([[0],{43:function(t,e,n){},51:function(t,e,n){"use strict";n.r(e);var a=n(2),r=n(0),s=n.n(r),i=n(20),l=n.n(i),c=(n(43),n(4)),o=n(10),u=n(44);var d=n(12),j=6371e3;function h(t){var e=t[0],n=t[t.length-1];function a(t,e){var n,a=0,r=0,s=-1,i=Object(o.a)(e);try{for(i.s();!(n=i.n()).done;){var l=n.value,c=Math.abs(f(l,t));if(c>s){var u=p(t,l);a=l.lat-u.lat,r=l.lon-u.lon,s=c}}}catch(d){i.e(d)}finally{i.f()}return[a,r,s]}function r(r,s){var i,l=[],c=[],u=Object(o.a)(t);try{for(u.s();!(i=u.n()).done;){var d=i.value;x(d,r.start)<x(d,r.end)?l.push(d):c.push(d)}}catch(M){u.e(M)}finally{u.f()}var j=a(r,l),h=a(r,c),b=r.end.lat-r.start.lat,v=r.end.lon-r.start.lon,f={start:{lat:r.start.lat+j[0]/s-b,lon:r.start.lon+j[1]/s-v},end:{lat:r.end.lat+h[0]/s+b,lon:r.end.lon+h[1]/s+v}},O=(j[2]+h[2])/2;return{arc:{start:p(f,e),end:p(f,n)},error:O}}for(var s=10,i=r({start:{lat:e.lat,lon:e.lon},end:{lat:n.lat,lon:n.lon}},s),l=0;l<50;l++){var c=r(i.arc,s);c.error<i.error?i=c:s+=1}return i.arc}function b(t){return 180*t/Math.PI}function v(t){return t*Math.PI/180}function f(t,e){var n=x(e.start,t)/j,a=v(O(e.start,t)),r=v(O(e.start,e.end));return Math.asin(Math.sin(n)*Math.sin(a-r))*j}function x(t,e){var n=v(t.lat),a=v(t.lon),r=v(e.lat),s=r-n,i=v(e.lon)-a,l=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(r)*Math.sin(i/2)*Math.sin(i/2),c=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return j*c}function O(t,e){var n=v(t.lat),a=v(e.lat),r=v(e.lon-t.lon),s=Math.cos(n)*Math.sin(a)-Math.sin(n)*Math.cos(a)*Math.cos(r),i=Math.sin(r)*Math.cos(a);return function(t){if(0<=t&&t<360)return t;return(t%360+360)%360}(b(Math.atan2(i,s)))}function p(t,e){return function t(e,n,a,r){var s=x(e.start,n);if(s>a-1e-6||r>100)return e.start;var i=x(e.end,n),l=Math.max(s,i),c=function(t,e){var n=v(t.lat),a=v(e.lat),r=v(t.lon),s=v(e.lon),i=Math.cos(a)*Math.cos(s-r),l=Math.cos(a)*Math.sin(s-r),c=Math.atan2(Math.sin(n)+Math.sin(a),Math.sqrt((Math.cos(n)+i)*(Math.cos(n)+i)+l*l)),o=r+Math.atan2(l,Math.cos(n)+i);return{lat:b(c),lon:b(o)}}(e.start,e.end);return t(s<i?{start:e.start,end:c}:{start:c,end:e.end},n,l,r+1)}(t,e,j,0)}var M={minDistanceBetweenPoints:5};function m(t){var e=s.a.useCallback((function(e){if(e.currentTarget.files){var n=new FileReader;n.onload=function(){var e=function(t,e){var n=Object(d.a)(Object(d.a)({},M),e),a=[],r=h(t),s=t[0],i=Math.abs(f(s,r));a.push(t[0]);for(var l=1;l<t.length;l++){var c=t[l],o=Math.abs(f(c,r));x(s,c)<n.minDistanceBetweenPoints&&o<i?console.log("skipped point: ".concat(c.lat,", ").concat(c.lon)):(i=o,s=c,a.push(c))}return a}(function(t){var e,n=[],a=Object(o.a)(t.tracks);try{for(a.s();!(e=a.n()).done;){var r,s=e.value,i=Object(o.a)(s.points);try{for(i.s();!(r=i.n()).done;){var l=r.value;isNaN(l.lat)||isNaN(l.lon)||n.push(l)}}catch(c){i.e(c)}finally{i.f()}}}catch(c){a.e(c)}finally{a.f()}return n}(function(t){var e=new u;return e.parse(t),e}(n.result)));t.onChange(e)},n.readAsText(e.currentTarget.files[0])}}),[t]);return Object(a.jsxs)("div",{style:{width:"150pt",margin:"auto"},children:["Select a GPX file to analyze",Object(a.jsx)("br",{}),Object(a.jsx)("input",{type:"file",onChange:e})]})}var y=n(64),g=n(46);function w(t,e){return g(t,e).format("FFf")}var S=Object(y.a)((function(t){return{root:{},label:{display:"inline-block",fontWeight:"bold",width:"35pt"},value:{display:"inline",whiteSpace:"nowrap"}}}));function P(t){var e=S(),n=t.arc?w(t.arc.start.lat,t.arc.start.lon):void 0,r=t.arc?w(t.arc.end.lat,t.arc.end.lon):void 0;return Object(a.jsxs)("div",{className:e.root,children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:e.label,children:"Start"}),Object(a.jsx)("div",{className:e.value,children:n})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:e.label,children:"End"}),Object(a.jsx)("div",{className:e.value,children:r})]})]})}var k=n(75),A=n(66),C=n(67),D=n(68),W=n(69),E=n(70),N=n(71),L=n(72);function F(t){var e=t.numberOfPoints||100,n=s.a.useState([]),r=Object(c.a)(n,2),i=r[0],l=r[1];s.a.useEffect((function(){var n,a=[],r=Object(o.a)(t.points);try{for(r.s();!(n=r.n()).done;){var s,i=n.value,c=Math.abs(f(i,t.arc));if(c>0)a.push({time:(null===(s=i.time)||void 0===s?void 0:s.toISOString())||"unknown",latLon:w(i.lat,i.lon),error:c.toFixed(1),errorVal:c,point:i}),a=(a=a.sort((function(t,e){return t.errorVal===e.errorVal?0:t.errorVal>e.errorVal?-1:1}))).slice(0,e)}}catch(u){r.e(u)}finally{r.f()}l(a)}),[t.arc,t.points,e]);var u=s.a.useCallback((function(e){t.onPointClick(e.point)}),[t.onPointClick]);return Object(a.jsx)(A.a,{component:C.a,style:{flexGrow:1,display:"flex"},children:Object(a.jsxs)(D.a,{stickyHeader:!0,children:[Object(a.jsx)(W.a,{children:Object(a.jsxs)(E.a,{children:[Object(a.jsx)(N.a,{children:"Time"}),Object(a.jsx)(N.a,{children:"Lat/Lon"}),Object(a.jsx)(N.a,{children:"Error"})]})}),Object(a.jsx)(L.a,{children:i.map((function(e){var n=!1;return t.selectedWorstPoint&&t.selectedWorstPoint.lat===e.point.lat&&t.selectedWorstPoint.lon===e.point.lon&&(n=!0),Object(a.jsx)(B,{pt:e,selected:n,onRowClick:u},e.time+e.latLon)}))})]})})}function B(t){return Object(a.jsxs)(E.a,{onClick:function(e){return t.onRowClick(t.pt)},selected:t.selected,style:{cursor:"pointer"},children:[Object(a.jsx)(N.a,{children:t.pt.time}),Object(a.jsx)(N.a,{children:t.pt.latLon}),Object(a.jsxs)(N.a,{children:[t.pt.error,"m"]})]})}var G=n(73),I=n(76),R=n(74),T=n(14);function V(t){var e=s.a.useState(void 0),n=Object(c.a)(e,2),r=n[0],i=n[1],l=s.a.useState(void 0),u=Object(c.a)(l,2),d=u[0],j=u[1],h=s.a.useState(void 0),b=Object(c.a)(h,2),v=b[0],f=b[1],x=s.a.useState(void 0),O=Object(c.a)(x,2),M=O[0],m=O[1];s.a.useEffect((function(){t.bestArc?f([[t.bestArc.start.lat,t.bestArc.start.lon],[t.bestArc.end.lat,t.bestArc.end.lon]]):f(void 0)}),[t.bestArc]),s.a.useEffect((function(){var e,n=void 0,a=[],r=Object(o.a)(t.points);try{for(r.s();!(e=r.n()).done;){var s=e.value,l=[s.lat,s.lon];a.push(l),n?n.extend(l):n=new T.LatLngBounds(l,l)}}catch(c){r.e(c)}finally{r.f()}j(a),i(n)}),[t.points]),s.a.useEffect((function(){if(t.selectedWorstPoint&&t.bestArc){var e=p(t.bestArc,t.selectedWorstPoint);m([[t.selectedWorstPoint.lat,t.selectedWorstPoint.lon],[e.lat,e.lon]])}else m(void 0)}),[t.points,t.selectedWorstPoint,t.bestArc]);return r?Object(a.jsxs)(G.a,{bounds:r,boundsOptions:{padding:[10,10]},style:{width:"100%",height:"100%"},children:[Object(a.jsx)(I.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),M?Object(a.jsx)(R.a,{pathOptions:{color:"green"},positions:M}):null,d?Object(a.jsx)(R.a,{pathOptions:{color:"blue"},positions:d}):null,v?Object(a.jsx)(R.a,{pathOptions:{color:"red"},positions:v}):null]}):null}function q(t){return Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(a.jsx)(z,{label:"Min",value:t.stats.min,units:"m"}),Object(a.jsx)(z,{label:"Max",value:t.stats.max,units:"m"}),Object(a.jsx)(z,{label:"Mean",value:t.stats.mean,units:"m"}),Object(a.jsx)(z,{label:"Sum",value:t.stats.sum,units:"m"}),Object(a.jsx)(z,{label:"StdDev",value:t.stats.stdDeviation}),Object(a.jsx)(z,{label:"Distance",value:t.stats.distance,units:"m"}),Object(a.jsx)(z,{label:"Sum/Distance",value:t.stats.sum/t.stats.distance,units:"m"})]})}function z(t){return Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(a.jsx)("div",{style:{width:"100pt"},children:t.label}),Object(a.jsxs)("div",{children:[(t.value||0).toFixed(2),t.units||""]})]})}function J(t){var e=s.a.useState(void 0),n=Object(c.a)(e,2),r=n[0],i=n[1],l=s.a.useState(void 0),u=Object(c.a)(l,2),d=u[0],j=u[1],b=s.a.useState(void 0),v=Object(c.a)(b,2),O=v[0],p=v[1];s.a.useEffect((function(){var e=h(t.points);i(e),j(function(t,e){var n,a=x(e.start,e.end),r=0,s=Number.MAX_SAFE_INTEGER,i=0,l=[],c=Object(o.a)(t);try{for(c.s();!(n=c.n()).done;){var u=n.value,d=Math.abs(f(u,e));l.push(d),r+=d,s=Math.min(s,d),i=Math.max(i,d)}}catch(h){c.e(h)}finally{c.f()}var j=r/t.length;return{sum:r,min:s,max:i,mean:j,stdDeviation:function(){for(var t=0,e=0,n=l;e<n.length;e++){var a=n[e];t+=Math.pow(a-j,2)}return Math.sqrt(t/l.length)}(),distance:a}}(t.points,e))}),[t.points]);var M=s.a.useCallback((function(t){p(t)}),[p]),m=r;return Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(a.jsxs)("div",{style:{marginRight:"10pt"},children:[Object(a.jsx)(k.a,{variant:"h6",children:"Best Arc"}),Object(a.jsx)(P,{arc:r})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)(k.a,{variant:"h6",children:"Stats"}),d?Object(a.jsx)(q,{stats:d}):null]})]}),Object(a.jsxs)("div",{style:{display:"flex",flexGrow:1,overflow:"hidden"},children:[Object(a.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:"50%"},children:[Object(a.jsx)(k.a,{variant:"h6",children:"Worst Points"}),m?Object(a.jsx)(F,{arc:m,points:t.points,selectedWorstPoint:O,onPointClick:M}):null]}),Object(a.jsxs)("div",{style:{flex:"50%"},children:[Object(a.jsx)(k.a,{variant:"h6",children:"Map"}),Object(a.jsx)(V,{points:t.points,bestArc:r,selectedWorstPoint:O})]})]})]})}var X=function(){var t=s.a.useState(void 0),e=Object(c.a)(t,2),n=e[0],r=e[1],i=s.a.useCallback((function(t){r(t)}),[r]);return n?Object(a.jsx)(J,{points:n}):Object(a.jsx)(m,{onChange:i})};l.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(X,{})}),document.getElementById("root"))}},[[51,1,2]]]);
//# sourceMappingURL=main.be9612e4.chunk.js.map